{"ast":null,"code":"var _jsxFileName = \"/Users/rayimovsunnatillo/Desktop/luxe-shop/client/src/contexts/CartContext.js\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport React, { createContext, useContext, useReducer, useEffect } from 'react';\nimport { useAuth } from './AuthContext';\n\n// Cart reducer for state management\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst cartReducer = (state, action) => {\n  switch (action.type) {\n    case 'LOAD_CART':\n      return {\n        ...state,\n        items: action.payload,\n        totalItems: action.payload.reduce((sum, item) => sum + item.quantity, 0)\n      };\n    case 'ADD_TO_CART':\n      const existingItemIndex = state.items.findIndex(item => item.productId === action.payload.productId && item.selectedColor === action.payload.selectedColor && item.selectedSize === action.payload.selectedSize);\n      let newItems;\n      if (existingItemIndex >= 0) {\n        // Update quantity if same product with same options exists\n        newItems = [...state.items];\n        newItems[existingItemIndex].quantity += action.payload.quantity;\n      } else {\n        // Add new item\n        newItems = [...state.items, action.payload];\n      }\n      localStorage.setItem(action.userId ? `cart_${action.userId}` : 'cart', JSON.stringify(newItems));\n      return {\n        ...state,\n        items: newItems,\n        totalItems: newItems.reduce((sum, item) => sum + item.quantity, 0)\n      };\n    case 'UPDATE_QUANTITY':\n      const updatedItems = state.items.map(item => item.id === action.payload.id ? {\n        ...item,\n        quantity: Math.max(1, action.payload.quantity)\n      } : item);\n      localStorage.setItem(action.userId ? `cart_${action.userId}` : 'cart', JSON.stringify(updatedItems));\n      return {\n        ...state,\n        items: updatedItems,\n        totalItems: updatedItems.reduce((sum, item) => sum + item.quantity, 0)\n      };\n    case 'REMOVE_FROM_CART':\n      const filteredItems = state.items.filter(item => item.id !== action.payload);\n      localStorage.setItem(action.userId ? `cart_${action.userId}` : 'cart', JSON.stringify(filteredItems));\n      return {\n        ...state,\n        items: filteredItems,\n        totalItems: filteredItems.reduce((sum, item) => sum + item.quantity, 0)\n      };\n    case 'CLEAR_CART':\n      localStorage.removeItem(action.userId ? `cart_${action.userId}` : 'cart');\n      return {\n        ...state,\n        items: [],\n        totalItems: 0\n      };\n    default:\n      return state;\n  }\n};\nconst CartContext = /*#__PURE__*/createContext();\nconst initialState = {\n  items: [],\n  totalItems: 0\n};\nexport const CartProvider = ({\n  children\n}) => {\n  _s();\n  const {\n    user,\n    isAuthenticated\n  } = useAuth();\n  const [state, dispatch] = useReducer(cartReducer, initialState);\n\n  // Load cart from localStorage on mount and when user changes\n  useEffect(() => {\n    const cartKey = user ? `cart_${user.id}` : 'cart';\n    const savedCart = localStorage.getItem(cartKey);\n    if (savedCart) {\n      try {\n        const cartItems = JSON.parse(savedCart);\n        dispatch({\n          type: 'LOAD_CART',\n          payload: cartItems\n        });\n      } catch (error) {\n        console.error('Error loading cart:', error);\n        localStorage.removeItem(cartKey);\n      }\n    } else {\n      // Clear cart if no saved cart for this user\n      dispatch({\n        type: 'LOAD_CART',\n        payload: []\n      });\n    }\n  }, [user]);\n  const addToCart = (product, selectedColor, selectedSize, quantity = 1) => {\n    const cartItem = {\n      id: Date.now().toString(),\n      // Unique ID for cart item\n      productId: product.id,\n      name: product.name,\n      price: product.price,\n      image: product.image,\n      selectedColor,\n      selectedSize,\n      quantity,\n      addedAt: new Date().toISOString()\n    };\n    dispatch({\n      type: 'ADD_TO_CART',\n      payload: cartItem,\n      userId: user === null || user === void 0 ? void 0 : user.id\n    });\n  };\n  const updateQuantity = (itemId, quantity) => {\n    dispatch({\n      type: 'UPDATE_QUANTITY',\n      payload: {\n        id: itemId,\n        quantity\n      },\n      userId: user === null || user === void 0 ? void 0 : user.id\n    });\n  };\n  const removeFromCart = itemId => {\n    dispatch({\n      type: 'REMOVE_FROM_CART',\n      payload: itemId,\n      userId: user === null || user === void 0 ? void 0 : user.id\n    });\n  };\n  const clearCart = () => {\n    dispatch({\n      type: 'CLEAR_CART',\n      userId: user === null || user === void 0 ? void 0 : user.id\n    });\n  };\n  const getCartTotal = () => {\n    return state.items.reduce((total, item) => {\n      const price = parseFloat(item.price.replace('$', ''));\n      return total + price * item.quantity;\n    }, 0);\n  };\n  return /*#__PURE__*/_jsxDEV(CartContext.Provider, {\n    value: {\n      items: state.items,\n      totalItems: state.totalItems,\n      addToCart,\n      updateQuantity,\n      removeFromCart,\n      clearCart,\n      getCartTotal\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 133,\n    columnNumber: 5\n  }, this);\n};\n_s(CartProvider, \"aPcIqT08T6HOLUrKX+gaTmjCreE=\", false, function () {\n  return [useAuth];\n});\n_c = CartProvider;\nexport const useCart = () => {\n  _s2();\n  const context = useContext(CartContext);\n  if (!context) {\n    throw new Error('useCart must be used within a CartProvider');\n  }\n  return context;\n};\n_s2(useCart, \"b9L3QQ+jgeyIrH0NfHrJ8nn7VMU=\");\nvar _c;\n$RefreshReg$(_c, \"CartProvider\");","map":{"version":3,"names":["React","createContext","useContext","useReducer","useEffect","useAuth","jsxDEV","_jsxDEV","cartReducer","state","action","type","items","payload","totalItems","reduce","sum","item","quantity","existingItemIndex","findIndex","productId","selectedColor","selectedSize","newItems","localStorage","setItem","userId","JSON","stringify","updatedItems","map","id","Math","max","filteredItems","filter","removeItem","CartContext","initialState","CartProvider","children","_s","user","isAuthenticated","dispatch","cartKey","savedCart","getItem","cartItems","parse","error","console","addToCart","product","cartItem","Date","now","toString","name","price","image","addedAt","toISOString","updateQuantity","itemId","removeFromCart","clearCart","getCartTotal","total","parseFloat","replace","Provider","value","fileName","_jsxFileName","lineNumber","columnNumber","_c","useCart","_s2","context","Error","$RefreshReg$"],"sources":["/Users/rayimovsunnatillo/Desktop/luxe-shop/client/src/contexts/CartContext.js"],"sourcesContent":["import React, { createContext, useContext, useReducer, useEffect } from 'react';\nimport { useAuth } from './AuthContext';\n\n// Cart reducer for state management\nconst cartReducer = (state, action) => {\n  switch (action.type) {\n    case 'LOAD_CART':\n      return {\n        ...state,\n        items: action.payload,\n        totalItems: action.payload.reduce((sum, item) => sum + item.quantity, 0)\n      };\n    case 'ADD_TO_CART':\n      const existingItemIndex = state.items.findIndex(\n        item => item.productId === action.payload.productId &&\n                item.selectedColor === action.payload.selectedColor &&\n                item.selectedSize === action.payload.selectedSize\n      );\n\n      let newItems;\n      if (existingItemIndex >= 0) {\n        // Update quantity if same product with same options exists\n        newItems = [...state.items];\n        newItems[existingItemIndex].quantity += action.payload.quantity;\n      } else {\n        // Add new item\n        newItems = [...state.items, action.payload];\n      }\n\n      localStorage.setItem(action.userId ? `cart_${action.userId}` : 'cart', JSON.stringify(newItems));\n      return {\n        ...state,\n        items: newItems,\n        totalItems: newItems.reduce((sum, item) => sum + item.quantity, 0)\n      };\n    case 'UPDATE_QUANTITY':\n      const updatedItems = state.items.map(item =>\n        item.id === action.payload.id\n          ? { ...item, quantity: Math.max(1, action.payload.quantity) }\n          : item\n      );\n      localStorage.setItem(action.userId ? `cart_${action.userId}` : 'cart', JSON.stringify(updatedItems));\n      return {\n        ...state,\n        items: updatedItems,\n        totalItems: updatedItems.reduce((sum, item) => sum + item.quantity, 0)\n      };\n    case 'REMOVE_FROM_CART':\n      const filteredItems = state.items.filter(item => item.id !== action.payload);\n      localStorage.setItem(action.userId ? `cart_${action.userId}` : 'cart', JSON.stringify(filteredItems));\n      return {\n        ...state,\n        items: filteredItems,\n        totalItems: filteredItems.reduce((sum, item) => sum + item.quantity, 0)\n      };\n    case 'CLEAR_CART':\n      localStorage.removeItem(action.userId ? `cart_${action.userId}` : 'cart');\n      return {\n        ...state,\n        items: [],\n        totalItems: 0\n      };\n    default:\n      return state;\n  }\n};\n\nconst CartContext = createContext();\n\nconst initialState = {\n  items: [],\n  totalItems: 0\n};\n\nexport const CartProvider = ({ children }) => {\n  const { user, isAuthenticated } = useAuth();\n  const [state, dispatch] = useReducer(cartReducer, initialState);\n\n  // Load cart from localStorage on mount and when user changes\n  useEffect(() => {\n    const cartKey = user ? `cart_${user.id}` : 'cart';\n    const savedCart = localStorage.getItem(cartKey);\n    if (savedCart) {\n      try {\n        const cartItems = JSON.parse(savedCart);\n        dispatch({ type: 'LOAD_CART', payload: cartItems });\n      } catch (error) {\n        console.error('Error loading cart:', error);\n        localStorage.removeItem(cartKey);\n      }\n    } else {\n      // Clear cart if no saved cart for this user\n      dispatch({ type: 'LOAD_CART', payload: [] });\n    }\n  }, [user]);\n\n  const addToCart = (product, selectedColor, selectedSize, quantity = 1) => {\n    const cartItem = {\n      id: Date.now().toString(), // Unique ID for cart item\n      productId: product.id,\n      name: product.name,\n      price: product.price,\n      image: product.image,\n      selectedColor,\n      selectedSize,\n      quantity,\n      addedAt: new Date().toISOString()\n    };\n\n    dispatch({ type: 'ADD_TO_CART', payload: cartItem, userId: user?.id });\n  };\n\n  const updateQuantity = (itemId, quantity) => {\n    dispatch({ type: 'UPDATE_QUANTITY', payload: { id: itemId, quantity }, userId: user?.id });\n  };\n\n  const removeFromCart = (itemId) => {\n    dispatch({ type: 'REMOVE_FROM_CART', payload: itemId, userId: user?.id });\n  };\n\n  const clearCart = () => {\n    dispatch({ type: 'CLEAR_CART', userId: user?.id });\n  };\n\n  const getCartTotal = () => {\n    return state.items.reduce((total, item) => {\n      const price = parseFloat(item.price.replace('$', ''));\n      return total + (price * item.quantity);\n    }, 0);\n  };\n\n  return (\n    <CartContext.Provider value={{\n      items: state.items,\n      totalItems: state.totalItems,\n      addToCart,\n      updateQuantity,\n      removeFromCart,\n      clearCart,\n      getCartTotal\n    }}>\n      {children}\n    </CartContext.Provider>\n  );\n};\n\nexport const useCart = () => {\n  const context = useContext(CartContext);\n  if (!context) {\n    throw new Error('useCart must be used within a CartProvider');\n  }\n  return context;\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}